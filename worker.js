//设置变量SUB,节点名称设为Country-名称，优选ip设置为ip.sb,会自动替换国家和优选
//订阅链接格式:域名/token=值?cf_port=值
const CONFIG = {
    TOKEN: '111',  //订阅链接密钥
    API: 'https://vps789.com/public/sum/cfIpApi;https://www.wetest.vip/api/cf2dns/get_cloudflare_ip&type=v4&key=o1zrmHAF',  //优选ip的api
    SUB: ''  //自定义链接,多个用;隔开
};
const _0x4ae68e=_0x4aea;(function(_0x7265b7,_0x1ee60c){const _0x288625=_0x4aea,_0x1e3ceb=_0x7265b7();while(!![]){try{const _0x31db0c=-parseInt(_0x288625(0x159))/0x1+parseInt(_0x288625(0x17d))/0x2+parseInt(_0x288625(0x15e))/0x3+parseInt(_0x288625(0x160))/0x4+-parseInt(_0x288625(0x17f))/0x5*(parseInt(_0x288625(0x171))/0x6)+-parseInt(_0x288625(0x170))/0x7*(parseInt(_0x288625(0x152))/0x8)+parseInt(_0x288625(0x16f))/0x9;if(_0x31db0c===_0x1ee60c)break;else _0x1e3ceb['push'](_0x1e3ceb['shift']());}catch(_0x221afe){_0x1e3ceb['push'](_0x1e3ceb['shift']());}}}(_0x1d8c,0xb4d25));function _0x1d8c(){const _0x2f4bfb=['xieyi','map','606436eVCtBo','://','10CHdwWi','https://','Error\x20processing\x20IP\x20data','unknown','No\x20valid\x20IP\x20data\x20found\x20from\x20any\x20API\x20endpoints','content-type','=none','Error\x20fetching\x20or\x20processing\x20IP\x20data:','Country','filter','json','all','Missing\x20cf_port','includes','parse','Error\x20fetching\x20country\x20for\x20IP\x20','get','match','url','application/json','API','status','https://ipinfo.io/','cf_port','charAt','startsWith','push','country','1853048JjYIBc','No\x20valid\x20IP\x20data\x20found','SUB','ess://','split','http://','toLowerCase','113545GsiJqU','some','log','Error\x20fetching\x20or\x20processing\x20data','ess','1919934vyujnw','text/plain','1404456iGACxC','{BASS}://','headers','trimStart','searchParams','replace','Error\x20fetching\x20data\x20from\x20','warn','isArray','xieyi2','object','hasOwnProperty','concat','error','8080','3639321vaIPCl','7IpewrQ','1838574yNGscU','trim','HTTP\x20Error\x20for\x20','Hello\x20World','text','pathname','订阅内容不是base64编码，使用原始内容','TOKEN','length','string'];_0x1d8c=function(){return _0x2f4bfb;};return _0x1d8c();}const excludeKeywords='GB-eu.com;TW-free.tw',PROTOCOL={'xieyi':'vl','xieyi2':_0x4ae68e(0x15d),'pm':'vm'};function preProcessUrl(_0x7d69cf){const _0x3e5f4e=_0x4ae68e,_0xeb2769=(_0x7d69cf[_0x3e5f4e(0x198)](_0x3e5f4e(0x161))||_0x7d69cf[_0x3e5f4e(0x198)](PROTOCOL['pm']+_0x3e5f4e(0x155)))&&_0x7d69cf[_0x3e5f4e(0x156)](_0x3e5f4e(0x17e))[0x1]['charAt'](0x0)!=='{';if(_0xeb2769){const _0x509c25=atob(_0x7d69cf[_0x3e5f4e(0x156)](_0x3e5f4e(0x17e))[0x1]);return PROTOCOL['pm']+_0x3e5f4e(0x155)+_0x509c25[_0x3e5f4e(0x165)](/\{PASS\}\-/g,'')[_0x3e5f4e(0x165)](/\{PA/g,PROTOCOL['xieyi'])[_0x3e5f4e(0x165)](/SS\}/g,PROTOCOL[_0x3e5f4e(0x169)])[_0x3e5f4e(0x165)](/\{BA/g,PROTOCOL['pm']);}return _0x7d69cf['replace'](/\{PASS\}\-/g,'')[_0x3e5f4e(0x165)](/\{PA/g,PROTOCOL[_0x3e5f4e(0x17b)])[_0x3e5f4e(0x165)](/SS\}/g,PROTOCOL[_0x3e5f4e(0x169)])[_0x3e5f4e(0x165)](/\{BA/g,PROTOCOL['pm']);}function _0x4aea(_0x34d94a,_0x58c23b){const _0x1d8c26=_0x1d8c();return _0x4aea=function(_0x4aea52,_0x1b058f){_0x4aea52=_0x4aea52-0x151;let _0x1ca053=_0x1d8c26[_0x4aea52];return _0x1ca053;},_0x4aea(_0x34d94a,_0x58c23b);}function shouldExcludeUrl(_0x396e0f){const _0x107ae8=_0x4ae68e;return excludeKeywords['split'](';')[_0x107ae8(0x17c)](_0x3023cd=>_0x3023cd[_0x107ae8(0x172)]())[_0x107ae8(0x15a)](_0x1565cc=>_0x396e0f[_0x107ae8(0x18c)](_0x1565cc));}function getSubUrls(_0x3d74a0){const _0x54b19e=_0x4ae68e;return(_0x3d74a0[_0x54b19e(0x154)]||'')[_0x54b19e(0x156)](';')['map'](_0x417b07=>_0x417b07[_0x54b19e(0x172)]())[_0x54b19e(0x188)](_0x4d92ed=>typeof _0x4d92ed===_0x54b19e(0x17a)&&!shouldExcludeUrl(_0x4d92ed));}async function extractIpsFromResponse(_0x585f13){const _0x27aff5=_0x4ae68e;let _0x53d7d3=[];const _0x47638c=_0x585f13[_0x27aff5(0x162)][_0x27aff5(0x18f)](_0x27aff5(0x184));let _0x3e0418;try{_0x3e0418=await _0x585f13[_0x27aff5(0x175)]();if(_0x47638c&&_0x47638c[_0x27aff5(0x18c)](_0x27aff5(0x192)))try{_0x3e0418=JSON[_0x27aff5(0x18d)](_0x3e0418);const _0x1ece16=_0xc6f593=>{const _0x561c4b=_0x27aff5;if(typeof _0xc6f593===_0x561c4b(0x17a)&&_0xc6f593[_0x561c4b(0x190)](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/))_0x53d7d3[_0x561c4b(0x199)](_0xc6f593[_0x561c4b(0x172)]());else{if(Array[_0x561c4b(0x168)](_0xc6f593))_0xc6f593['forEach'](_0x3c1458=>{const _0xe08ec0=_0x561c4b;if(typeof _0x3c1458==='object')_0x1ece16(_0x3c1458);else typeof _0x3c1458===_0xe08ec0(0x17a)&&_0x3c1458['match'](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/)&&_0x53d7d3[_0xe08ec0(0x199)](_0x3c1458[_0xe08ec0(0x172)]());});else{if(typeof _0xc6f593===_0x561c4b(0x16a)&&_0xc6f593!==null)for(const _0x5d18de in _0xc6f593){_0xc6f593[_0x561c4b(0x16b)](_0x5d18de)&&_0x1ece16(_0xc6f593[_0x5d18de]);}}}};_0x1ece16(_0x3e0418);}catch(_0x3a2ad1){console[_0x27aff5(0x16d)]('Error\x20parsing\x20JSON',_0x3a2ad1);const _0x546748=_0x3e0418[_0x27aff5(0x190)](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g)||[];_0x53d7d3[_0x27aff5(0x199)](..._0x546748);}else{const _0x138a6b=_0x3e0418['match'](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g)||[];_0x53d7d3[_0x27aff5(0x199)](..._0x138a6b);}}catch(_0xbdd0e4){console[_0x27aff5(0x16d)](_0x27aff5(0x15c),_0xbdd0e4);}return[...new Set(_0x53d7d3)][_0x27aff5(0x188)](Boolean);}export default{async 'fetch'(_0x4526bd,_0x290cf9){const _0x58affb=_0x4ae68e,_0x4a6523=new URL(_0x4526bd[_0x58affb(0x191)]);if(_0x4a6523['pathname']==='/'||_0x4a6523[_0x58affb(0x176)]==='')return new Response(_0x58affb(0x174),{'headers':{'content-type':_0x58affb(0x15f)}});if(_0x4a6523['pathname']==='/token='+CONFIG[_0x58affb(0x178)])return handleToken(_0x4526bd,_0x290cf9);return new Response('Not\x20Found',{'status':0x194});}};async function handleToken(_0x1bd897,_0x1c95c5){const _0x1d6f74=_0x4ae68e,_0x2c11c1=new URL(_0x1bd897[_0x1d6f74(0x191)])[_0x1d6f74(0x164)][_0x1d6f74(0x18f)](_0x1d6f74(0x196));if(!_0x2c11c1)return new Response(_0x1d6f74(0x18b),{'status':0x190});let _0x38b450=[];const _0xeda711=(CONFIG[_0x1d6f74(0x193)]||'')[_0x1d6f74(0x156)](';')[_0x1d6f74(0x17c)](_0xd1e452=>_0xd1e452['trim']())[_0x1d6f74(0x188)](Boolean);if(_0xeda711[_0x1d6f74(0x179)]===0x0)return new Response('No\x20API\x20endpoints\x20provided',{'status':0x190});try{let _0x2c45af=[];for(const _0x1e3954 of _0xeda711){try{const _0x2f4c41=await fetch(_0x1e3954);if(!_0x2f4c41['ok']){console[_0x1d6f74(0x16d)](_0x1d6f74(0x173)+_0x1e3954+':\x20'+_0x2f4c41[_0x1d6f74(0x194)]);continue;}const _0x273e42=await extractIpsFromResponse(_0x2f4c41);_0x2c45af[_0x1d6f74(0x199)](..._0x273e42);}catch(_0x53b669){console[_0x1d6f74(0x16d)](_0x1d6f74(0x166)+_0x1e3954+':',_0x53b669);}}if(_0x2c45af[_0x1d6f74(0x179)]===0x0)return new Response(_0x1d6f74(0x183),{'status':0x190});const _0x280923=[...new Set(_0x2c45af)][_0x1d6f74(0x188)](Boolean);_0x38b450=await Promise[_0x1d6f74(0x18a)](_0x280923['map'](async _0x1e36a4=>{const _0x49fec9=_0x1d6f74;try{const _0x58ac02=await fetch(_0x49fec9(0x195)+_0x1e36a4+'/json');if(!_0x58ac02['ok'])return console[_0x49fec9(0x167)]('Error\x20fetching\x20country\x20for\x20IP\x20'+_0x1e36a4+':\x20'+_0x58ac02[_0x49fec9(0x194)]),{'ip':_0x1e36a4,'country':_0x49fec9(0x182)};return{'ip':_0x1e36a4,'country':(await _0x58ac02[_0x49fec9(0x189)]())[_0x49fec9(0x151)]||_0x49fec9(0x182)};}catch(_0x29fda){return console[_0x49fec9(0x167)](_0x49fec9(0x18e)+_0x1e36a4+':\x20'+_0x29fda),{'ip':_0x1e36a4,'country':_0x49fec9(0x182)};}}));if(_0x38b450['length']===0x0)return new Response(_0x1d6f74(0x153),{'status':0x190});}catch(_0x1d556a){return console['error'](_0x1d6f74(0x186),_0x1d556a),new Response(_0x1d6f74(0x181),{'status':0x1f4});}let _0x1b8151=getSubUrls(_0x1c95c5);const _0x4e239b=_0x1b8151[_0x1d6f74(0x188)](_0x31c582=>!excludeKeywords[_0x1d6f74(0x156)](';')[_0x1d6f74(0x17c)](_0x46c332=>_0x46c332[_0x1d6f74(0x172)]())[_0x1d6f74(0x15a)](_0x19061b=>_0x31c582['includes'](_0x19061b)));let _0x4f419d=[];for(const _0x30f0f3 of _0x4e239b){if(_0x30f0f3[_0x1d6f74(0x18c)](_0x1d6f74(0x187)))for(const _0x40c865 of _0x38b450){let _0x4223df=_0x30f0f3[_0x1d6f74(0x165)](/ip\.sb/g,_0x40c865['ip'])['replace'](/Country/g,_0x40c865[_0x1d6f74(0x151)])[_0x1d6f74(0x165)](/\b(443|8443)\b/g,_0x2c11c1)['replace'](/CF_PORT/g,_0x2c11c1);(_0x2c11c1==='80'||_0x2c11c1===_0x1d6f74(0x16e))&&(_0x4223df=_0x4223df['replace'](/=tls/g,_0x1d6f74(0x185))[_0x1d6f74(0x165)](/tls\",/g,'\x22,')),_0x4f419d[_0x1d6f74(0x199)](_0x4223df);}else{let _0x12ee63=_0x30f0f3[_0x1d6f74(0x165)](/YOUXUAN_IP|ip\.sb/g,_0x38b450[0x0]['ip'])['replace'](/\b(443|8443)\b/g,_0x2c11c1)['replace'](/CF_PORT/g,_0x2c11c1);(_0x2c11c1==='80'||_0x2c11c1===_0x1d6f74(0x16e))&&(_0x12ee63=_0x12ee63[_0x1d6f74(0x165)](/=tls/g,'=none')['replace'](/tls\",/g,'\x22,')),_0x4f419d[_0x1d6f74(0x199)](_0x12ee63);}}let _0x7b5dae=[];for(const _0x5f3d87 of _0x4f419d){if(_0x5f3d87[_0x1d6f74(0x158)]()[_0x1d6f74(0x198)](_0x1d6f74(0x157))||_0x5f3d87[_0x1d6f74(0x158)]()['startsWith'](_0x1d6f74(0x180)))try{const _0x5befd2=await fetch(_0x5f3d87);let _0x442f29=await _0x5befd2['text']();try{_0x442f29=atob(_0x442f29);}catch(_0x5f3405){console[_0x1d6f74(0x15b)](_0x1d6f74(0x177));}const _0x2d0415=_0x442f29[_0x1d6f74(0x156)]('\x0a')['filter'](_0x371d8b=>_0x371d8b['trim']())[_0x1d6f74(0x188)](_0x374e9a=>!shouldExcludeUrl(_0x374e9a));_0x7b5dae=_0x7b5dae[_0x1d6f74(0x16c)](_0x2d0415);}catch(_0x403b7d){console[_0x1d6f74(0x16d)]('处理订阅链接失败:',_0x403b7d);}else _0x7b5dae[_0x1d6f74(0x199)](_0x5f3d87);}_0x7b5dae=_0x7b5dae['map'](_0x3cec28=>{const _0x5dbfb2=_0x1d6f74;if(_0x3cec28[_0x5dbfb2(0x198)](_0x5dbfb2(0x161))||_0x3cec28['startsWith'](PROTOCOL['pm']+_0x5dbfb2(0x155))){const _0x4dea63=_0x3cec28['split'](_0x5dbfb2(0x17e))[0x1];if(_0x4dea63&&_0x4dea63[_0x5dbfb2(0x163)]()[_0x5dbfb2(0x197)](0x0)==='{')return PROTOCOL['pm']+'ess://'+btoa(_0x4dea63);}return _0x3cec28;});const _0x339549=btoa(_0x7b5dae['join']('\x0a'));return new Response(_0x339549,{'headers':{'Content-Type':_0x1d6f74(0x15f)}});}