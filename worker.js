//设置变量SUB,节点名称设为Country-名称，优选ip设置为ip.sb,会自动替换国家和优选
//订阅链接格式:域名/token=值?cf_port=值
const CONFIG = {
    TOKEN: '111',  //订阅链接密钥
    API: 'https://ip.164746.xyz/ipTop10.html;https://vps789.com/public/sum/cfIpApi;https://www.wetest.vip/api/cf2dns/get_cloudflare_ip&type=v4&key=o1zrmHAF',  //优选ip的api,多个用;隔开
    SUB: ''  //自定义链接,多个用;隔开
};
//过滤关键词节点
const excludeKeywords = 'GB-eu.com;TW-free.tw';

(function(_0x2a0eb1,_0x34af73){const _0x3cc3cc=_0x2fa9,_0x44ddc2=_0x2a0eb1();while(!![]){try{const _0x4615fa=parseInt(_0x3cc3cc(0x120))/0x1+-parseInt(_0x3cc3cc(0xe9))/0x2+parseInt(_0x3cc3cc(0x107))/0x3*(parseInt(_0x3cc3cc(0xfc))/0x4)+parseInt(_0x3cc3cc(0x10b))/0x5*(-parseInt(_0x3cc3cc(0x104))/0x6)+parseInt(_0x3cc3cc(0x117))/0x7+parseInt(_0x3cc3cc(0x12f))/0x8+-parseInt(_0x3cc3cc(0x119))/0x9*(parseInt(_0x3cc3cc(0x10d))/0xa);if(_0x4615fa===_0x34af73)break;else _0x44ddc2['push'](_0x44ddc2['shift']());}catch(_0x11fd76){_0x44ddc2['push'](_0x44ddc2['shift']());}}}(_0x294e,0x5c0a5));const PROTOCOL={'xieyi':'vl','xieyi2':'ess','pm':'vm'};function preProcessUrl(_0x73bc2e){const _0x15be3b=_0x2fa9,_0x17cf60=(_0x73bc2e[_0x15be3b(0x11c)](_0x15be3b(0xfd))||_0x73bc2e[_0x15be3b(0x11c)](PROTOCOL['pm']+_0x15be3b(0x11d)))&&_0x73bc2e[_0x15be3b(0x12a)](_0x15be3b(0x124))[0x1][_0x15be3b(0x103)](0x0)!=='{';if(_0x17cf60){const _0x58c98d=atob(_0x73bc2e[_0x15be3b(0x12a)](_0x15be3b(0x124))[0x1]);return PROTOCOL['pm']+'ess://'+_0x58c98d['replace'](/\{PASS\}\-/g,'')['replace'](/\{PA/g,PROTOCOL['xieyi'])['replace'](/SS\}/g,PROTOCOL[_0x15be3b(0xee)])[_0x15be3b(0xff)](/\{BA/g,PROTOCOL['pm']);}return _0x73bc2e[_0x15be3b(0xff)](/\{PASS\}\-/g,'')['replace'](/\{PA/g,PROTOCOL[_0x15be3b(0x112)])[_0x15be3b(0xff)](/SS\}/g,PROTOCOL[_0x15be3b(0xee)])[_0x15be3b(0xff)](/\{BA/g,PROTOCOL['pm']);}function shouldExcludeUrl(_0x5edbd2){const _0x4020cd=_0x2fa9;return excludeKeywords['split'](';')[_0x4020cd(0x110)](_0x36f55d=>_0x36f55d['trim']())[_0x4020cd(0xfe)](_0xbd5fdd=>_0x5edbd2[_0x4020cd(0xf0)](_0xbd5fdd));}function getSubUrls(_0x24910a){const _0x12c778=_0x2fa9;return(_0x24910a[_0x12c778(0x113)]||'')['split'](';')[_0x12c778(0x110)](_0x1648cf=>_0x1648cf[_0x12c778(0xed)]())[_0x12c778(0x110)](_0x1b852a=>preProcessUrl(_0x1b852a))[_0x12c778(0x121)](_0x49016d=>typeof _0x49016d==='string'&&!shouldExcludeUrl(_0x49016d));}function _0x2fa9(_0xcd6e60,_0x14db57){const _0x294e8d=_0x294e();return _0x2fa9=function(_0x2fa92f,_0x20beb3){_0x2fa92f=_0x2fa92f-0xe6;let _0x5b600a=_0x294e8d[_0x2fa92f];return _0x5b600a;},_0x2fa9(_0xcd6e60,_0x14db57);}async function extractIpsFromResponse(_0x5db3f5){const _0xf57e82=_0x2fa9;let _0xf6f1bd=[];const _0x455f6e=_0x5db3f5['headers'][_0xf57e82(0xf8)](_0xf57e82(0x111));let _0x24c4f7;try{_0x24c4f7=await _0x5db3f5[_0xf57e82(0xf3)]();if(_0x455f6e&&_0x455f6e[_0xf57e82(0xf0)](_0xf57e82(0xec)))try{_0x24c4f7=JSON[_0xf57e82(0xe7)](_0x24c4f7);const _0x1915b4=_0x11b698=>{const _0x5bcd99=_0xf57e82;if(typeof _0x11b698==='string'&&_0x11b698[_0x5bcd99(0x11e)](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/))_0xf6f1bd['push'](_0x11b698['trim']());else{if(Array[_0x5bcd99(0x118)](_0x11b698))_0x11b698[_0x5bcd99(0x12d)](_0x1de680=>{const _0x452c59=_0x5bcd99;if(typeof _0x1de680===_0x452c59(0x125))_0x1915b4(_0x1de680);else typeof _0x1de680===_0x452c59(0x126)&&_0x1de680[_0x452c59(0x11e)](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/)&&_0xf6f1bd[_0x452c59(0x10c)](_0x1de680[_0x452c59(0xed)]());});else{if(typeof _0x11b698===_0x5bcd99(0x125)&&_0x11b698!==null)for(const _0x5ee039 in _0x11b698){_0x11b698[_0x5bcd99(0x101)](_0x5ee039)&&_0x1915b4(_0x11b698[_0x5ee039]);}}}};_0x1915b4(_0x24c4f7);}catch(_0x282907){console['error'](_0xf57e82(0x11f),_0x282907);const _0x340511=_0x24c4f7[_0xf57e82(0x11e)](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g)||[];_0xf6f1bd[_0xf57e82(0x10c)](..._0x340511);}else{const _0x30d3b2=_0x24c4f7[_0xf57e82(0x11e)](/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g)||[];_0xf6f1bd[_0xf57e82(0x10c)](..._0x30d3b2);}}catch(_0x22f6d6){console[_0xf57e82(0xfa)](_0xf57e82(0x11b),_0x22f6d6);}return[...new Set(_0xf6f1bd)][_0xf57e82(0x121)](Boolean);}export default{async 'fetch'(_0x4d296d,_0x50197f){const _0x4eb203=_0x2fa9,_0x4393b9=new URL(_0x4d296d[_0x4eb203(0x127)]);if(_0x4393b9['pathname']==='/'||_0x4393b9[_0x4eb203(0xf1)]==='')return new Response(_0x4eb203(0x10f),{'headers':{'content-type':_0x4eb203(0x12c)}});if(_0x4393b9[_0x4eb203(0xf1)]===_0x4eb203(0xf7)+CONFIG[_0x4eb203(0xf2)])return handleToken(_0x4d296d,_0x50197f);return new Response('Not\x20Found',{'status':0x194});}};function _0x294e(){const _0x3f7d1b=['HTTP\x20Error\x20for\x20','/token=','get','cf_port','error','Error\x20fetching\x20or\x20processing\x20IP\x20data:','42116PZuffQ','{BASS}://','some','replace','toLowerCase','hasOwnProperty','join','charAt','1245954pWyLsp','unknown','Error\x20fetching\x20country\x20for\x20IP\x20','72VOVpof','=none','country','https://ipinfo.io/','15ygrZFe','push','36980lWOfSF','No\x20valid\x20IP\x20data\x20found\x20from\x20any\x20API\x20endpoints','Hello\x20World','map','content-type','xieyi','SUB','/json','status','Missing\x20cf_port','5049632LNaOLH','isArray','324SKGFfR','Country','Error\x20fetching\x20or\x20processing\x20data','startsWith','ess://','match','Error\x20parsing\x20JSON','118670ewokRW','filter','log','No\x20valid\x20IP\x20data\x20found','://','object','string','url','searchParams','length','split','处理订阅链接失败:','text/plain','forEach','Error\x20processing\x20IP\x20data','2920264fEwMya','API','parse','json','649346kjQDzZ','https://','订阅内容不是base64编码，使用原始内容','application/json','trim','xieyi2','trimStart','includes','pathname','TOKEN','text','No\x20API\x20endpoints\x20provided','warn'];_0x294e=function(){return _0x3f7d1b;};return _0x294e();}async function handleToken(_0x59c59f,_0x20bda2){const _0x20cf5d=_0x2fa9,_0x3190ad=new URL(_0x59c59f[_0x20cf5d(0x127)])[_0x20cf5d(0x128)][_0x20cf5d(0xf8)](_0x20cf5d(0xf9));if(!_0x3190ad)return new Response(_0x20cf5d(0x116),{'status':0x190});let _0x1a1c0d=[];const _0x5946c3=(CONFIG[_0x20cf5d(0xe6)]||'')['split'](';')['map'](_0x59e6f4=>_0x59e6f4['trim']())[_0x20cf5d(0x121)](Boolean);if(_0x5946c3[_0x20cf5d(0x129)]===0x0)return new Response(_0x20cf5d(0xf4),{'status':0x190});try{let _0x1a0e64=[];for(const _0x3e504a of _0x5946c3){try{const _0x1bc8a8=await fetch(_0x3e504a);if(!_0x1bc8a8['ok']){console[_0x20cf5d(0xfa)](_0x20cf5d(0xf6)+_0x3e504a+':\x20'+_0x1bc8a8[_0x20cf5d(0x115)]);continue;}const _0x37301c=await extractIpsFromResponse(_0x1bc8a8);_0x1a0e64[_0x20cf5d(0x10c)](..._0x37301c);}catch(_0x158434){console[_0x20cf5d(0xfa)]('Error\x20fetching\x20data\x20from\x20'+_0x3e504a+':',_0x158434);}}if(_0x1a0e64[_0x20cf5d(0x129)]===0x0)return new Response(_0x20cf5d(0x10e),{'status':0x190});const _0x1673ea=[...new Set(_0x1a0e64)][_0x20cf5d(0x121)](Boolean);_0x1a1c0d=await Promise['all'](_0x1673ea['map'](async _0x1b20a2=>{const _0x3fab52=_0x20cf5d;try{const _0xa2554e=await fetch(_0x3fab52(0x10a)+_0x1b20a2+_0x3fab52(0x114));if(!_0xa2554e['ok'])return console[_0x3fab52(0xf5)](_0x3fab52(0x106)+_0x1b20a2+':\x20'+_0xa2554e[_0x3fab52(0x115)]),{'ip':_0x1b20a2,'country':'unknown'};return{'ip':_0x1b20a2,'country':(await _0xa2554e[_0x3fab52(0xe8)]())[_0x3fab52(0x109)]||_0x3fab52(0x105)};}catch(_0x8dbdbc){return console[_0x3fab52(0xf5)]('Error\x20fetching\x20country\x20for\x20IP\x20'+_0x1b20a2+':\x20'+_0x8dbdbc),{'ip':_0x1b20a2,'country':_0x3fab52(0x105)};}}));if(_0x1a1c0d['length']===0x0)return new Response(_0x20cf5d(0x123),{'status':0x190});}catch(_0xbd38d1){return console[_0x20cf5d(0xfa)](_0x20cf5d(0xfb),_0xbd38d1),new Response(_0x20cf5d(0x12e),{'status':0x1f4});}let _0x2e7cca=getSubUrls(_0x20bda2);const _0x27e556=_0x2e7cca[_0x20cf5d(0x121)](_0xd8e70d=>!excludeKeywords[_0x20cf5d(0x12a)](';')['map'](_0x518adf=>_0x518adf[_0x20cf5d(0xed)]())[_0x20cf5d(0xfe)](_0x5f3fe7=>_0xd8e70d[_0x20cf5d(0xf0)](_0x5f3fe7)));let _0x42ae61=[];for(const _0xbdd7b4 of _0x27e556){if(_0xbdd7b4[_0x20cf5d(0xf0)](_0x20cf5d(0x11a)))for(const _0x3a2ca7 of _0x1a1c0d){let _0x19a3cc=_0xbdd7b4[_0x20cf5d(0xff)](/ip\.sb/g,_0x3a2ca7['ip'])[_0x20cf5d(0xff)](/Country/g,_0x3a2ca7['country'])['replace'](/\b(443|8443)\b/g,_0x3190ad)[_0x20cf5d(0xff)](/CF_PORT/g,_0x3190ad);(_0x3190ad==='80'||_0x3190ad==='8080')&&(_0x19a3cc=_0x19a3cc['replace'](/=tls/g,_0x20cf5d(0x108))[_0x20cf5d(0xff)](/tls\",/g,'\x22,')),_0x42ae61['push'](_0x19a3cc);}else{let _0x13a30c=_0xbdd7b4[_0x20cf5d(0xff)](/YOUXUAN_IP|ip\.sb/g,_0x1a1c0d[0x0]['ip'])[_0x20cf5d(0xff)](/\b(443|8443)\b/g,_0x3190ad)[_0x20cf5d(0xff)](/CF_PORT/g,_0x3190ad);(_0x3190ad==='80'||_0x3190ad==='8080')&&(_0x13a30c=_0x13a30c[_0x20cf5d(0xff)](/=tls/g,_0x20cf5d(0x108))[_0x20cf5d(0xff)](/tls\",/g,'\x22,')),_0x42ae61[_0x20cf5d(0x10c)](_0x13a30c);}}let _0x361e57=[];for(const _0x9efcd2 of _0x42ae61){if(_0x9efcd2[_0x20cf5d(0x100)]()['startsWith']('http://')||_0x9efcd2[_0x20cf5d(0x100)]()['startsWith'](_0x20cf5d(0xea)))try{const _0x22fa0b=await fetch(_0x9efcd2);let _0x205910=await _0x22fa0b[_0x20cf5d(0xf3)]();try{_0x205910=atob(_0x205910);}catch(_0x1a727f){console[_0x20cf5d(0x122)](_0x20cf5d(0xeb));}const _0x18439b=_0x205910[_0x20cf5d(0x12a)]('\x0a')[_0x20cf5d(0x121)](_0x34e5d5=>_0x34e5d5[_0x20cf5d(0xed)]())[_0x20cf5d(0x121)](_0x2ce24b=>!shouldExcludeUrl(_0x2ce24b));_0x361e57=_0x361e57['concat'](_0x18439b);}catch(_0x4d2ffa){console[_0x20cf5d(0xfa)](_0x20cf5d(0x12b),_0x4d2ffa);}else _0x361e57[_0x20cf5d(0x10c)](_0x9efcd2);}_0x361e57=_0x361e57[_0x20cf5d(0x110)](_0x224f50=>{const _0x1493d3=_0x20cf5d;if(_0x224f50[_0x1493d3(0x11c)]('{BASS}://')||_0x224f50[_0x1493d3(0x11c)](PROTOCOL['pm']+_0x1493d3(0x11d))){const _0x368763=_0x224f50[_0x1493d3(0x12a)](_0x1493d3(0x124))[0x1];if(_0x368763&&_0x368763[_0x1493d3(0xef)]()['charAt'](0x0)==='{')return PROTOCOL['pm']+_0x1493d3(0x11d)+btoa(_0x368763);}return _0x224f50;});const _0x3886b1=btoa(_0x361e57[_0x20cf5d(0x102)]('\x0a'));return new Response(_0x3886b1,{'headers':{'Content-Type':_0x20cf5d(0x12c)}});}