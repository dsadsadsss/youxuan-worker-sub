//设置变量SUB,节点类型vl+ess,节点名称设为Country-名称，优选ip设置为ip.sb,会自动替换国家和优选
//订阅链接格式:域名/token=值?cf_port=值
const CONFIG = {
    TOKEN: '111',  //订阅链接密钥
    API: 'https://vps789.com/public/sum/cfIpApi',  //优选ip的api
    SUB: ''  //自定义链接,多个用;隔开
};

const excludeKeywords = 'GB-eu.com;TW-free.tw';
const _0x2d2b0a=_0x5216;(function(_0x4fbbe4,_0x4412d3){const _0x5e8721=_0x5216,_0x5eff43=_0x4fbbe4();while(!![]){try{const _0xab7df5=parseInt(_0x5e8721(0xb2))/0x1*(-parseInt(_0x5e8721(0x92))/0x2)+parseInt(_0x5e8721(0x81))/0x3+-parseInt(_0x5e8721(0x84))/0x4+parseInt(_0x5e8721(0x9b))/0x5+parseInt(_0x5e8721(0x7f))/0x6+parseInt(_0x5e8721(0xb0))/0x7*(-parseInt(_0x5e8721(0x96))/0x8)+-parseInt(_0x5e8721(0x93))/0x9*(-parseInt(_0x5e8721(0xaf))/0xa);if(_0xab7df5===_0x4412d3)break;else _0x5eff43['push'](_0x5eff43['shift']());}catch(_0x22343d){_0x5eff43['push'](_0x5eff43['shift']());}}}(_0x4e10,0x3bf11));const PROTOCOL={'xieyi':'vl','xieyi2':_0x2d2b0a(0x7e),'pm':'vm'};function preProcessUrl(_0x9432b1){const _0x2c9e04=_0x2d2b0a,_0x443047=(_0x9432b1[_0x2c9e04(0x7c)](_0x2c9e04(0x94))||_0x9432b1[_0x2c9e04(0x7c)](PROTOCOL['pm']+_0x2c9e04(0x98)))&&_0x9432b1[_0x2c9e04(0x91)](_0x2c9e04(0xac))[0x1][_0x2c9e04(0x9a)](0x0)!=='{';if(_0x443047){const _0x433488=atob(_0x9432b1[_0x2c9e04(0x91)](_0x2c9e04(0xac))[0x1]);return PROTOCOL['pm']+_0x2c9e04(0x98)+_0x433488[_0x2c9e04(0x83)](/\{PASS\}\-/g,'')[_0x2c9e04(0x83)](/\{PA/g,PROTOCOL['xieyi'])[_0x2c9e04(0x83)](/SS\}/g,PROTOCOL[_0x2c9e04(0x89)])[_0x2c9e04(0x83)](/\{BA/g,PROTOCOL['pm']);}return _0x9432b1[_0x2c9e04(0x83)](/\{PASS\}\-/g,'')['replace'](/\{PA/g,PROTOCOL['xieyi'])[_0x2c9e04(0x83)](/SS\}/g,PROTOCOL['xieyi2'])[_0x2c9e04(0x83)](/\{BA/g,PROTOCOL['pm']);}function _0x5216(_0x24c5e9,_0x4a67ac){const _0x4e105e=_0x4e10();return _0x5216=function(_0x5216bd,_0x4b5e4c){_0x5216bd=_0x5216bd-0x77;let _0x300426=_0x4e105e[_0x5216bd];return _0x300426;},_0x5216(_0x24c5e9,_0x4a67ac);}function shouldExcludeUrl(_0x4541c4){const _0x121603=_0x2d2b0a;return excludeKeywords[_0x121603(0x91)](';')[_0x121603(0x8b)](_0x520c1e=>_0x520c1e[_0x121603(0x80)]())[_0x121603(0x77)](_0x11230d=>_0x4541c4['includes'](_0x11230d));}function getSubUrls(_0x90a82b){const _0x58d04e=_0x2d2b0a;return(_0x90a82b['SUB']||'')[_0x58d04e(0x91)](';')[_0x58d04e(0x8b)](_0x53e1bd=>_0x53e1bd[_0x58d04e(0x80)]())['filter'](_0x3b4d26=>typeof _0x3b4d26===_0x58d04e(0x97)&&!shouldExcludeUrl(_0x3b4d26));}export default{async 'fetch'(_0x391cf3,_0x1e7765){const _0x160695=_0x2d2b0a,_0x31fc48=new URL(_0x391cf3['url']);if(_0x31fc48[_0x160695(0x9d)]==='/'||_0x31fc48[_0x160695(0x9d)]==='')return new Response(_0x160695(0xa8),{'headers':{'content-type':_0x160695(0x8a)}});if(_0x31fc48['pathname']==='/token='+CONFIG[_0x160695(0x9f)])return handleToken(_0x391cf3,_0x1e7765);return new Response(_0x160695(0xa9),{'status':0x194});}};function _0x4e10(){const _0x3572c7=['Hello\x20World','Not\x20Found','Country','push','://','Missing\x20cf_port','log','20hogEfH','447076BwhxUk','订阅内容不是base64编码，使用原始内容','24481wLAhlr','some','API','join','warn','trimStart','startsWith','concat','ess','1037052mXsiTT','trim','724623dTGWNJ','=none','replace','1732436NaIwQP','all','8080','/json','data','xieyi2','text/plain','map','HTTP\x20Error:\x20','text','country','Error\x20fetching\x20country\x20for\x20IP\x20','filter','split','38ElWmss','3621483aKATid','{BASS}://','json','56qZFBeS','string','ess://','cf_port','charAt','1858440Xoligk','error','pathname','https://','TOKEN','status','Error\x20fetching\x20IP\x20data','unknown','url','get','http://','searchParams','includes'];_0x4e10=function(){return _0x3572c7;};return _0x4e10();}async function handleToken(_0x50f0f5,_0xeb05d8){const _0x245dfb=_0x2d2b0a,_0x215b39=new URL(_0x50f0f5[_0x245dfb(0xa3)])[_0x245dfb(0xa6)][_0x245dfb(0xa4)](_0x245dfb(0x99));if(!_0x215b39)return new Response(_0x245dfb(0xad),{'status':0x190});let _0x99d824=[];try{const _0x1d4516=await fetch(CONFIG[_0x245dfb(0x78)]);if(!_0x1d4516['ok'])return console['error'](_0x245dfb(0x8c)+_0x1d4516['status']),new Response(_0x245dfb(0xa1),{'status':0x1f4});const _0x50d17b=await _0x1d4516['json']();if(_0x50d17b&&_0x50d17b['data']){const {CT:_0x2fdba3,CU:_0xe6dd93,CM:_0x47d48b,AllAvg:_0x2ea30e}=_0x50d17b[_0x245dfb(0x88)],_0xe1fa82=[...(_0x2fdba3||[])[_0x245dfb(0x8b)](_0x30fd0a=>_0x30fd0a['ip']),...(_0xe6dd93||[])[_0x245dfb(0x8b)](_0x2a13df=>_0x2a13df['ip']),...(_0x47d48b||[])[_0x245dfb(0x8b)](_0x52763c=>_0x52763c['ip']),...(_0x2ea30e||[])[_0x245dfb(0x8b)](_0x2596f2=>_0x2596f2['ip'])],_0x16962d=[...new Set(_0xe1fa82)][_0x245dfb(0x90)](Boolean);_0x99d824=await Promise[_0x245dfb(0x85)](_0x16962d[_0x245dfb(0x8b)](async _0x2199f6=>{const _0x4107b8=_0x245dfb;try{const _0x21c20c=await fetch('https://ipinfo.io/'+_0x2199f6+_0x4107b8(0x87));if(!_0x21c20c['ok'])return console[_0x4107b8(0x7a)](_0x4107b8(0x8f)+_0x2199f6+':\x20'+_0x21c20c[_0x4107b8(0xa0)]),{'ip':_0x2199f6,'country':_0x4107b8(0xa2)};return{'ip':_0x2199f6,'country':(await _0x21c20c[_0x4107b8(0x95)]())[_0x4107b8(0x8e)]||_0x4107b8(0xa2)};}catch(_0x2a3e7e){return console['warn'](_0x4107b8(0x8f)+_0x2199f6+':\x20'+_0x2a3e7e),{'ip':_0x2199f6,'country':_0x4107b8(0xa2)};}}));}if(_0x99d824['length']===0x0)return new Response('No\x20valid\x20IP\x20data\x20found',{'status':0x190});}catch(_0x4637e1){return console[_0x245dfb(0x9c)]('Error\x20fetching\x20or\x20processing\x20IP\x20data:',_0x4637e1),new Response('Error\x20processing\x20IP\x20data',{'status':0x1f4});}let _0x59dcf7=getSubUrls(_0xeb05d8);const _0x3ed33a=_0x59dcf7[_0x245dfb(0x90)](_0x1bf95d=>!excludeKeywords[_0x245dfb(0x91)](';')['map'](_0xe57669=>_0xe57669[_0x245dfb(0x80)]())[_0x245dfb(0x77)](_0x1bb300=>_0x1bf95d[_0x245dfb(0xa7)](_0x1bb300)));let _0x36d3bb=[];for(const _0x2b0117 of _0x3ed33a){if(_0x2b0117[_0x245dfb(0xa7)](_0x245dfb(0xaa)))for(const _0x12ba1a of _0x99d824){let _0x245a93=_0x2b0117[_0x245dfb(0x83)](/ip\.sb/g,_0x12ba1a['ip'])[_0x245dfb(0x83)](/Country/g,_0x12ba1a[_0x245dfb(0x8e)])[_0x245dfb(0x83)](/\b(443|8443)\b/g,_0x215b39)[_0x245dfb(0x83)](/CF_PORT/g,_0x215b39);(_0x215b39==='80'||_0x215b39===_0x245dfb(0x86))&&(_0x245a93=_0x245a93[_0x245dfb(0x83)](/=tls/g,_0x245dfb(0x82))[_0x245dfb(0x83)](/tls\",/g,'\x22,')),_0x36d3bb['push'](_0x245a93);}else{let _0x20270d=_0x2b0117[_0x245dfb(0x83)](/YOUXUAN_IP|ip\.sb/g,_0x99d824[0x0]['ip'])[_0x245dfb(0x83)](/\b(443|8443)\b/g,_0x215b39)['replace'](/CF_PORT/g,_0x215b39);(_0x215b39==='80'||_0x215b39===_0x245dfb(0x86))&&(_0x20270d=_0x20270d['replace'](/=tls/g,_0x245dfb(0x82))[_0x245dfb(0x83)](/tls\",/g,'\x22,')),_0x36d3bb[_0x245dfb(0xab)](_0x20270d);}}let _0x230f55=[];for(const _0x10b4d2 of _0x36d3bb){if(_0x10b4d2['toLowerCase']()[_0x245dfb(0x7c)](_0x245dfb(0xa5))||_0x10b4d2['toLowerCase']()[_0x245dfb(0x7c)](_0x245dfb(0x9e)))try{const _0x81cd97=await fetch(_0x10b4d2);let _0x1cf0d2=await _0x81cd97[_0x245dfb(0x8d)]();try{_0x1cf0d2=atob(_0x1cf0d2);}catch(_0x5001d6){console[_0x245dfb(0xae)](_0x245dfb(0xb1));}const _0x3509e1=_0x1cf0d2[_0x245dfb(0x91)]('\x0a')[_0x245dfb(0x90)](_0x5e9b20=>_0x5e9b20[_0x245dfb(0x80)]())[_0x245dfb(0x90)](_0x286485=>!shouldExcludeUrl(_0x286485));_0x230f55=_0x230f55[_0x245dfb(0x7d)](_0x3509e1);}catch(_0x3e819e){console[_0x245dfb(0x9c)]('处理订阅链接失败:',_0x3e819e);}else _0x230f55[_0x245dfb(0xab)](_0x10b4d2);}_0x230f55=_0x230f55[_0x245dfb(0x8b)](_0x262d0b=>{const _0x16f0ef=_0x245dfb;if(_0x262d0b[_0x16f0ef(0x7c)](_0x16f0ef(0x94))||_0x262d0b[_0x16f0ef(0x7c)](PROTOCOL['pm']+_0x16f0ef(0x98))){const _0x2f51=_0x262d0b[_0x16f0ef(0x91)](_0x16f0ef(0xac))[0x1];if(_0x2f51&&_0x2f51[_0x16f0ef(0x7b)]()[_0x16f0ef(0x9a)](0x0)==='{')return PROTOCOL['pm']+_0x16f0ef(0x98)+btoa(_0x2f51);}return _0x262d0b;});const _0x37d517=btoa(_0x230f55[_0x245dfb(0x79)]('\x0a'));return new Response(_0x37d517,{'headers':{'Content-Type':_0x245dfb(0x8a)}});}
